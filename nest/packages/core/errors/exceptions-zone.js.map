{"version":3,"file":"exceptions-zone.js","sourceRoot":"/Users/hanxiaoxue/Documents/work/frontEndDebugger/nest/packages/core/","sources":["errors/exceptions-zone.ts"],"names":[],"mappings":";;;AAAA,2CAAwC;AACxC,2DAAuD;AAEvD,MAAM,gBAAgB,GAAG,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAE/C,MAAa,cAAc;IAGlB,MAAM,CAAC,GAAG,CACf,QAAoB,EACpB,WAA+B,gBAAgB,EAC/C,aAAuB;QAEvB,IAAI;YACF,QAAQ,EAAE,CAAC;SACZ;QAAC,OAAO,CAAC,EAAE;YACV,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YAChC,IAAI,aAAa,EAAE;gBACjB,eAAM,CAAC,KAAK,EAAE,CAAC;aAChB;YACD,QAAQ,CAAC,CAAC,CAAC,CAAC;SACb;IACH,CAAC;IAEM,MAAM,CAAC,KAAK,CAAC,QAAQ,CAC1B,QAA6B,EAC7B,WAA+B,gBAAgB,EAC/C,aAAuB;QAEvB,IAAI;YACF,MAAM,QAAQ,EAAE,CAAC;SAClB;QAAC,OAAO,CAAC,EAAE;YACV,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YAChC,IAAI,aAAa,EAAE;gBACjB,eAAM,CAAC,KAAK,EAAE,CAAC;aAChB;YACD,QAAQ,CAAC,CAAC,CAAC,CAAC;SACb;IACH,CAAC;;AAhCuB,+BAAgB,GAAG,IAAI,oCAAgB,EAAE,CAAC;AADvD,wCAAc","sourcesContent":["import { Logger } from '@nestjs/common';\nimport { ExceptionHandler } from './exception-handler';\n\nconst DEFAULT_TEARDOWN = () => process.exit(1);\n\nexport class ExceptionsZone {\n  private static readonly exceptionHandler = new ExceptionHandler();\n\n  public static run(\n    callback: () => void,\n    teardown: (err: any) => void = DEFAULT_TEARDOWN,\n    autoFlushLogs?: boolean,\n  ) {\n    try {\n      callback();\n    } catch (e) {\n      this.exceptionHandler.handle(e);\n      if (autoFlushLogs) {\n        Logger.flush();\n      }\n      teardown(e);\n    }\n  }\n\n  public static async asyncRun(\n    callback: () => Promise<void>,\n    teardown: (err: any) => void = DEFAULT_TEARDOWN,\n    autoFlushLogs?: boolean,\n  ) {\n    try {\n      await callback();\n    } catch (e) {\n      this.exceptionHandler.handle(e);\n      if (autoFlushLogs) {\n        Logger.flush();\n      }\n      teardown(e);\n    }\n  }\n}\n"]}