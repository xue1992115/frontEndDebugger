{"version":3,"file":"parse-int.pipe.js","sourceRoot":"/Users/hanxiaoxue/Documents/work/frontEndDebugger/nest/packages/common/","sources":["pipes/parse-int.pipe.ts"],"names":[],"mappings":";;;;AAAA,kFAAqE;AACrE,8EAAiE;AACjE,gEAAuD;AAKvD,8EAG0C;AAU1C;;;;;;GAMG;AACH,IACa,YAAY,GADzB,MACa,YAAY;IAGvB,YAAwB,OAA6B;QACnD,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;QACxB,MAAM,EAAE,gBAAgB,EAAE,mBAAmB,GAAG,6BAAU,CAAC,WAAW,EAAE,GACtE,OAAO,CAAC;QAEV,IAAI,CAAC,gBAAgB;YACnB,gBAAgB;gBAChB,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,yCAAe,CAAC,mBAAmB,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;IAC/D,CAAC;IAED;;;;;;OAMG;IACH,KAAK,CAAC,SAAS,CAAC,KAAa,EAAE,QAA0B;QACvD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;YAC1B,MAAM,IAAI,CAAC,gBAAgB,CACzB,gDAAgD,CACjD,CAAC;SACH;QACD,OAAO,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACO,SAAS,CAAC,KAAa;QAC/B,OAAO,CACL,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,QAAQ,CAAC,OAAO,KAAK,CAAC;YAC3C,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC;YACrB,QAAQ,CAAC,KAAY,CAAC,CACvB,CAAC;IACJ,CAAC;CACF,CAAA;AAxCY,YAAY;IADxB,IAAA,iCAAU,GAAE;IAIE,mBAAA,IAAA,6BAAQ,GAAE,CAAA;;GAHZ,YAAY,CAwCxB;AAxCY,oCAAY","sourcesContent":["import { Injectable } from '../decorators/core/injectable.decorator';\nimport { Optional } from '../decorators/core/optional.decorator';\nimport { HttpStatus } from '../enums/http-status.enum';\nimport {\n  ArgumentMetadata,\n  PipeTransform,\n} from '../interfaces/features/pipe-transform.interface';\nimport {\n  ErrorHttpStatusCode,\n  HttpErrorByCode,\n} from '../utils/http-error-by-code.util';\n\n/**\n * @publicApi\n */\nexport interface ParseIntPipeOptions {\n  errorHttpStatusCode?: ErrorHttpStatusCode;\n  exceptionFactory?: (error: string) => any;\n}\n\n/**\n * Defines the built-in ParseInt Pipe\n *\n * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)\n *\n * @publicApi\n */\n@Injectable()\nexport class ParseIntPipe implements PipeTransform<string> {\n  protected exceptionFactory: (error: string) => any;\n\n  constructor(@Optional() options?: ParseIntPipeOptions) {\n    options = options || {};\n    const { exceptionFactory, errorHttpStatusCode = HttpStatus.BAD_REQUEST } =\n      options;\n\n    this.exceptionFactory =\n      exceptionFactory ||\n      (error => new HttpErrorByCode[errorHttpStatusCode](error));\n  }\n\n  /**\n   * Method that accesses and performs optional transformation on argument for\n   * in-flight requests.\n   *\n   * @param value currently processed route argument\n   * @param metadata contains metadata about the currently processed route argument\n   */\n  async transform(value: string, metadata: ArgumentMetadata): Promise<number> {\n    if (!this.isNumeric(value)) {\n      throw this.exceptionFactory(\n        'Validation failed (numeric string is expected)',\n      );\n    }\n    return parseInt(value, 10);\n  }\n\n  /**\n   * @param value currently processed route argument\n   * @returns `true` if `value` is a valid integer number\n   */\n  protected isNumeric(value: string): boolean {\n    return (\n      ['string', 'number'].includes(typeof value) &&\n      /^-?\\d+$/.test(value) &&\n      isFinite(value as any)\n    );\n  }\n}\n"]}