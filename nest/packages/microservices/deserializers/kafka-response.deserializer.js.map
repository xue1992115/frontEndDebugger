{"version":3,"file":"kafka-response.deserializer.js","sourceRoot":"","sources":["kafka-response.deserializer.ts"],"names":[],"mappings":";;;AAAA,oEAAgE;AAChE,oEAA2D;AAG3D;;GAEG;AACH,MAAa,yBAAyB;IAGpC,WAAW,CAAC,OAAY,EAAE,OAA6B;QACrD,MAAM,EAAE,GAAG,OAAO,CAAC,OAAO,CAAC,iCAAY,CAAC,cAAc,CAAC,CAAC,QAAQ,EAAE,CAAC;QACnE,IAAI,CAAC,IAAA,0BAAW,EAAC,OAAO,CAAC,OAAO,CAAC,iCAAY,CAAC,QAAQ,CAAC,CAAC,EAAE;YACxD,OAAO;gBACL,EAAE;gBACF,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,iCAAY,CAAC,QAAQ,CAAC;gBAC3C,UAAU,EAAE,IAAI;aACjB,CAAC;SACH;QACD,IAAI,CAAC,IAAA,0BAAW,EAAC,OAAO,CAAC,OAAO,CAAC,iCAAY,CAAC,gBAAgB,CAAC,CAAC,EAAE;YAChE,OAAO;gBACL,EAAE;gBACF,QAAQ,EAAE,OAAO,CAAC,KAAK;gBACvB,UAAU,EAAE,IAAI;aACjB,CAAC;SACH;QACD,OAAO;YACL,EAAE;YACF,QAAQ,EAAE,OAAO,CAAC,KAAK;YACvB,UAAU,EAAE,KAAK;SAClB,CAAC;IACJ,CAAC;CACF;AAzBD,8DAyBC","sourcesContent":["import { isUndefined } from '@nestjs/common/utils/shared.utils';\nimport { KafkaHeaders } from '../enums/kafka-headers.enum';\nimport { Deserializer, IncomingResponse } from '../interfaces';\n\n/**\n * @publicApi\n */\nexport class KafkaResponseDeserializer\n  implements Deserializer<any, IncomingResponse>\n{\n  deserialize(message: any, options?: Record<string, any>): IncomingResponse {\n    const id = message.headers[KafkaHeaders.CORRELATION_ID].toString();\n    if (!isUndefined(message.headers[KafkaHeaders.NEST_ERR])) {\n      return {\n        id,\n        err: message.headers[KafkaHeaders.NEST_ERR],\n        isDisposed: true,\n      };\n    }\n    if (!isUndefined(message.headers[KafkaHeaders.NEST_IS_DISPOSED])) {\n      return {\n        id,\n        response: message.value,\n        isDisposed: true,\n      };\n    }\n    return {\n      id,\n      response: message.value,\n      isDisposed: false,\n    };\n  }\n}\n"]}